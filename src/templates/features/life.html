<style>
  .uie-life{height:100%;display:flex;flex-direction:column;padding:12px;gap:10px;color:#f6e7c8;font-family:system-ui,sans-serif;}
  .life-top{display:flex;align-items:center;justify-content:space-between;gap:10px;}
  .life-title{font-weight:900;letter-spacing:.02em;}
  .life-actions{display:flex;gap:8px;align-items:center;}
  .life-btn{padding:8px 12px;border-radius:14px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.03);color:#f6e7c8;font-weight:900;cursor:pointer;-webkit-tap-highlight-color:transparent;touch-action:manipulation;}
  .life-btn:active{transform:scale(.99);}
  .life-btn.icon{width:40px;height:40px;padding:0;display:grid;place-items:center;}
  .life-list{flex:1;overflow:auto;display:flex;flex-direction:column;gap:10px;padding-right:2px;}
  .life-card{border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.03);border-radius:18px;padding:12px;}
  .life-card.selecting{cursor:pointer;}
  .life-card.selected{border-color:rgba(241,196,15,.45); box-shadow:0 0 0 1px rgba(241,196,15,.25);}
  .life-row{display:flex;align-items:center;justify-content:space-between;gap:10px;}
  .life-name{font-weight:900;display:flex;gap:10px;align-items:center;}
  .life-dot{width:10px;height:10px;border-radius:999px;border:1px solid rgba(255,255,255,.18);background:#8d6e3a;flex:0 0 auto;}
  .life-meta{color:rgba(255,255,255,.65);font-size:12px;font-weight:800;white-space:nowrap;}
  .life-bar{height:10px;border-radius:999px;background:rgba(0,0,0,.25);overflow:hidden;border:1px solid rgba(255,255,255,.06);margin-top:10px;}
  .life-fill{height:100%;width:0%;background:#8d6e3a;}
  .life-ctrls{margin-top:10px;display:flex;justify-content:flex-end;gap:8px;}
  .life-mini{padding:8px 12px;border-radius:14px;border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.03);color:#cdd6f4;font-weight:900;cursor:pointer;-webkit-tap-highlight-color:transparent;touch-action:manipulation;}
  .life-pick{width:22px;height:22px;border-radius:999px;border:1px solid rgba(255,255,255,.18);display:grid;place-items:center;color:rgba(255,255,255,.75);flex:0 0 auto;}
  .life-pick.on{border-color:rgba(241,196,15,.55); color:#f1c40f;}

  /* Modal: FIX cutoff by using fixed + inner scroll */
  .life-modal{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.55);
    z-index:2147483656;
    align-items:center;
    justify-content:center;
    padding:14px;
  }
  .life-modal .box{
    width:100%;
    max-width:460px;
    max-height:88vh;
    overflow:auto;
    border-radius:18px;
    border:1px solid rgba(255,255,255,.12);
    background:rgba(20,18,28,.96);
    padding:12px;
  }
  .life-modal .box h3{margin:0;font-size:14px;font-weight:900;}
  .life-modal input[type="text"],
  .life-modal input[type="number"],
  .life-modal textarea{
    width:100%;
    padding:10px 12px;
    border-radius:14px;
    border:1px solid rgba(255,255,255,.10);
    background:rgba(255,255,255,.03);
    color:#f6e7c8;
    outline:none;
  }
  .life-modal textarea{resize:none;height:110px;}
  .life-modal .grid{margin-top:10px;display:grid;grid-template-columns:1fr 1fr;gap:10px;}
  .life-modal .row{display:flex;gap:10px;margin-top:10px;}
  .life-modal .row button{flex:1;}
  .life-modal .danger{border-color:rgba(243,139,168,.35);color:#f38ba8;}
  .life-modal .colorwrap{display:flex;align-items:center;gap:10px;}
  .life-modal input[type="color"]{width:44px;height:44px;border-radius:12px;border:1px solid rgba(255,255,255,.10);background:transparent;padding:0;}
  .life-help{margin-top:10px;color:rgba(255,255,255,.72);font-size:12px;font-weight:800;line-height:1.35;}
</style>

<div class="uie-life">
  <div class="life-top">
    <div class="life-title">Life Trackers</div>
    <div class="life-actions">
      <button class="life-btn icon" id="life-btn-trash" title="Delete Mode"><i class="fa-solid fa-trash"></i></button>
      <button class="life-btn danger" id="life-btn-delete" style="display:none;">Delete</button>
      <button class="life-btn" id="life-btn-cancel-delete" style="display:none;">Cancel</button>
      <button class="life-btn" id="life-btn-template">Template</button>
      <button class="life-btn" id="life-btn-add">New</button>
    </div>
  </div>

  <div class="life-list" id="life-list"></div>
</div>

<!-- Create modal (sparkle-style, newbie-friendly) -->
<div class="life-modal" id="life-modal-create">
  <div class="box">
    <div class="life-row">
      <h3>Create Tracker</h3>
      <button class="life-btn" id="life-create-close" title="Close">✖</button>
    </div>

    <div class="life-help">
      Make trackers like Hunger, Corruption, Sanity, Heat, Relationship… anything.  
      The AI will update them in the same message when Life Tracking is enabled.
    </div>

    <div class="grid">
      <input type="text" id="life-create-name" placeholder="Name (e.g., Hunger)">
      <div class="colorwrap">
        <input type="color" id="life-create-color" value="#8d6e3a">
        <div style="font-weight:900;color:rgba(255,255,255,.7);">Color</div>
      </div>

      <input type="number" id="life-create-current" placeholder="Current" value="0" min="-999999" max="999999">
      <input type="number" id="life-create-max" placeholder="Max" value="100" min="0" max="999999">

      <textarea id="life-create-notes" placeholder="Notes (optional). Example: “If Hunger reaches 0, you collapse.”"></textarea>
    </div>

    <div class="row">
      <button class="life-btn danger" id="life-create-cancel">Cancel</button>
      <button class="life-btn" id="life-create-save">Create</button>
    </div>
  </div>
</div>

<!-- Edit modal -->
<div class="life-modal" id="life-modal-edit">
  <div class="box">
    <div class="life-row">
      <h3 id="life-edit-title">Edit Tracker</h3>
      <button class="life-btn" id="life-edit-close" title="Close">✖</button>
    </div>

    <div class="grid">
      <input type="text" id="life-edit-name" placeholder="Tracker name">
      <div class="colorwrap">
        <input type="color" id="life-edit-color" value="#8d6e3a">
        <div style="font-weight:900;color:rgba(255,255,255,.7);">Color</div>
      </div>

      <input type="number" id="life-edit-current" placeholder="Current" min="-999999" max="999999">
      <input type="number" id="life-edit-max" placeholder="Max" min="0" max="999999">

      <textarea id="life-edit-notes" placeholder="Notes / rules..."></textarea>
    </div>

    <div class="row">
      <button class="life-btn danger" id="life-edit-delete">Delete</button>
      <button class="life-btn" id="life-edit-save">Save</button>
    </div>
  </div>
</div>

<!-- Template modal -->
<div class="life-modal" id="life-modal-template">
  <div class="box">
    <div class="life-row">
      <h3>AI Tracking Template</h3>
      <button class="life-btn" id="life-template-close" title="Close">✖</button>
    </div>

    <div class="life-help">
      This is injected into the same generation output.  
      It forces tracker updates without realism-policing.
    </div>

    <textarea id="life-template-text" placeholder="Write your strict template here..."></textarea>

    <div class="row">
      <button class="life-btn" id="life-template-reset">Reset</button>
      <button class="life-btn" id="life-template-save">Save</button>
    </div>
  </div>
</div>
