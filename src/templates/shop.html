<style>
  #uie-shop-window{ top: 15vh; left: 15vw; transform:none; width:min(500px, 80vw); height:min(600px, 70vh); background:rgba(11,15,21,0.96); position: fixed; z-index:2147483646; pointer-events:auto; display:flex; flex-direction:column; border:1px solid rgba(225,193,122,0.2); border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,0.5); }
  #uie-shop-window::before,
  #uie-shop-window::after{ content:none !important; }
  #uie-shop-window .uie-content{ position: relative; z-index:1; flex:1; min-height:0; overflow:auto; }
  #uie-shop-window .uie-header{
    display:flex !important;
    align-items:center !important;
    justify-content:space-between !important;
    flex-direction:row !important;
    position:relative !important;
    padding: 10px 15px !important;
    width: 100% !important;
    height: auto !important;
    flex-shrink: 0 !important;
    background: linear-gradient(90deg, #1b202b, #0e121a) !important;
    border-bottom: 1px solid rgba(225,193,122,0.18) !important;
    border-radius: 12px 12px 0 0 !important;
  }
  #uie-shop-window .uie-header,
  #uie-shop-window .uie-header *{
    writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
    transform: none !important;
  }
  #uie-shop-window .uie-info{
    display:flex !important;
    flex-direction:column !important;
    writing-mode: horizontal-tb !important;
  }
  #uie-shop-window .uie-header h2{
    font-size: 1.1em !important;
    line-height: 1.2 !important;
    margin: 0 !important;
    writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
    transform: none !important;
  }
  @media (max-width: 700px), (pointer: coarse) {
    #uie-shop-window {
      top: 6vh;
      left: 4vw;
      width: 91vw;
      max-width: 91vw;
      height: 87vh;
      max-height: 87vh;
    }
    #uie-shop-window .uie-header{
      padding: 8px 10px !important;
      font-size: 0.9em !important;
    }
    #uie-shop-window .uie-header h2{
      font-size: 0.95em !important;
    }
  }
</style>
<div id="uie-shop-window" class="uie-window" style="display:none;">
  <div class="uie-header" style="border-bottom:1px solid rgba(225,193,122,0.18); background:linear-gradient(90deg,#1b202b,#0e121a);">
      <div class="uie-info" style="display:flex; flex-direction:column;">
          <h2 style="margin:0; font-family:serif; color:#cba35c; letter-spacing:1px;">Shop</h2>
          <div style="font-size:12px; color:#aaa;">Merchant stock is generated from chat context.</div>
      </div>
      <div style="margin-left:auto; display:flex; align-items:center; gap:10px;">
          <div id="uie-shop-balance" style="font-weight:900; color:#f1c40f;">0 G</div>
          <i class="fa-solid fa-circle-question" onclick="uie.phone.openBooksGuide('guide-shop')" title="Help / Guide" style="cursor:pointer; color:#cba35c; margin-right:6px;"></i>
          <button id="uie-shop-refresh" title="Refresh" style="height:34px; width:40px; border-radius:12px; border:1px solid rgba(255,255,255,0.15); background:rgba(0,0,0,0.25); color:#fff; cursor:pointer;"><i class="fa-solid fa-rotate-right"></i></button>
          <i class="fa-solid fa-xmark uie-close-btn" id="uie-shop-close"></i>
      </div>
  </div>

  <div class="uie-content" style="padding:12px; display:flex; flex-direction:column; gap:10px; height:calc(100% - 65px);">
      <div style="display:flex; gap:8px;">
          <input id="uie-shop-keywords" type="text" placeholder="Keywords: potions, ammo, cybernetics..." style="flex:1; background:#000; border:1px solid #333; color:#fff; padding:10px; border-radius:12px;">
          <button id="uie-shop-generate" style="height:40px; padding:0 14px; border-radius:12px; border:none; background:#cba35c; color:#000; font-weight:900; cursor:pointer;"><i class="fa-solid fa-wand-magic-sparkles"></i></button>
      </div>

      <div id="uie-shop-items" style="flex:1; overflow:auto; display:flex; flex-direction:column; gap:10px;">
          <div style="opacity:0.75; padding:14px; border:1px dashed rgba(255,255,255,0.18); border-radius:14px; text-align:center; color:#888;">
              Generate a catalog to begin.
          </div>
      </div>
  </div>

  <!-- Templates -->
  <template id="uie-shop-item-template">
    <div class="uie-shop-item" style="display:flex; gap:10px; align-items:center; padding:12px; border-radius:14px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.25);">
        <div class="uie-shop-icon" style="width:42px; height:42px; border-radius:14px; border:1px solid rgba(225,193,122,0.25); background:rgba(0,0,0,0.35); display:flex; align-items:center; justify-content:center; color:#cba35c; font-size:18px;"></div>
        <div style="flex:1; min-width:0;">
            <div class="uie-shop-name" style="font-weight:900; color:#fff; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"></div>
            <div class="uie-shop-desc" style="opacity:0.75; font-size:12px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"></div>
        </div>
        <div style="text-align:right;">
            <div class="uie-shop-price" style="font-weight:900; color:#f1c40f;"></div>
            <button class="uie-shop-buy" style="margin-top:6px; height:34px; padding:0 12px; border-radius:12px; border:none; font-weight:900; cursor:pointer;">BUY</button>
        </div>
    </div>
  </template>

  <template id="uie-shop-empty-template">
      <div style="opacity:0.75; padding:14px; border:1px dashed rgba(255,255,255,0.18); border-radius:14px; text-align:center; color:#888;">
          Generate a catalog to begin.
      </div>
  </template>
</div>
