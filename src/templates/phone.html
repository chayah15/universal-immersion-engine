<div id="uie-phone-window" class="uie-phone" style="display:none;">
    <style id="uie-phone-custom-css"></style>
    <style>
        #uie-phone-window .phone-app-header { 
            padding: 8px 10px !important; 
            min-height: 44px !important;
            height: auto !important;
            border-bottom: 1px solid rgba(255,255,255,0.15) !important; 
            background: rgba(20, 25, 40, 0.86) !important; 
            backdrop-filter: blur(10px);
            color: #fff;
            display: flex; 
            align-items: center; 
            gap: 10px;
        }
        #uie-phone-window .phone-app-header > span { 
            font-weight: 700; 
            font-size: 0.80em !important;
            flex: 1; 
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        #uie-phone-window .phone-app-content { padding-top: 6px; }
        #uie-phone-window .phone-back-btn { padding: 0 4px !important; border-radius: 8px !important; }
        #uie-phone-window .phone-app-header i { font-size: 12px !important; }
        #uie-phone-window .phone-app-window { backdrop-filter: blur(8px); }
        #uie-phone-window #p-browser-content { background: transparent !important; }
        #uie-phone-window #p-browser-home,
        #uie-phone-window #p-browser-refresh { display: none !important; }
        #uie-phone-window .phone-back-btn{
            display: grid !important;
            place-items: center !important;
            width: 22px !important;
            height: 22px !important;
            padding: 0 !important;
            margin-top: 4px !important;
            border-radius: 8px !important;
            background: rgba(0,0,0,0.45) !important;
            color: rgba(255,255,255,0.95) !important;
            text-shadow: 0 1px 2px rgba(0,0,0,0.65) !important;
            border: 1px solid rgba(255,255,255,0.12) !important;
            cursor: pointer !important;
            pointer-events: auto !important;
            flex: 0 0 auto !important;
        }
        #uie-phone-window .phone-back-btn,
        #uie-phone-window .phone-back-btn i{ color: rgba(255,255,255,0.95) !important; }
        #uie-phone-window .phone-back-btn i{ color: rgba(255,255,255,0.95) !important; }
        #uie-phone-window .phone-back-btn:active{ transform: translateY(1px); }
        #uie-phone-window .phone-app-header{ color: rgba(255,255,255,0.95) !important; }
        #uie-phone-window #contact-add-manual{
            margin-right: 34px !important;
            margin-top: 4px !important;
            padding: 10px !important;
        }
        #uie-phone-window #msg-new-number{
            position: relative;
            top: 2px;
            left: 2px;
        }
        #uie-phone-window .p-browser-bar{
            display:flex;
            gap:8px;
            align-items:center;
            padding:8px 10px;
            flex-wrap:wrap;
        }
        #uie-phone-window #p-browser-url{
            flex: 1 1 240px;
            min-width: 0;
            height: 34px;
            max-height: 70px;
            overflow:auto;
            resize: none;
            border-radius: 12px;
            padding: 6px 10px;
            line-height: 1.25;
        }
        #uie-phone-window #p-browser-back,
        #uie-phone-window #p-browser-fwd,
        #uie-phone-window #p-browser-go,
        #uie-phone-window #p-browser-save{
            width: 34px;
            height: 34px;
            border-radius: 12px;
            flex: 0 0 auto;
            display:grid;
            place-items:center;
        }

        #uie-phone-homescreen{ overflow: hidden !important; }
        #uie-phone-window .phone-grid-scroll{
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 110px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }
        #uie-phone-window .phone-grid-scroll::-webkit-scrollbar{ width: 0; height: 0; }

        @media (max-width: 700px), (pointer: coarse) {
            #uie-phone-window.uie-phone {
                top: 12vh !important;
                left: 50% !important;
                right: auto !important;
                transform: translateX(-50%) !important;
                width: min(280px, 92vw) !important;
                height: min(550px, 82vh) !important;
                max-width: 92vw !important;
                max-height: 82vh !important;
                border-width: 4px !important;
                box-sizing: border-box !important;
            }
        }
        
        /* Line Clamp Fix (Modular) */
        .browser-bm-title {
            display: -webkit-box; -webkit-line-clamp: 1; line-clamp: 1;
            -webkit-box-orient: vertical; overflow: hidden;
            white-space: normal;
        }
    </style>
    
    <div class="phone-status-bar">
        <span class="uie-phone-clock">12:00</span>
        <span><i class="fa-solid fa-wifi"></i> 5G</span>
    </div>
    
    <div id="uie-phone-lockscreen" class="phone-screen">
        <style>
            #uie-phone-lockscreen{
                display:flex;
                flex-direction:column;
                align-items:center;
                justify-content:center;
                text-align:center;
                padding: 20px;
                box-sizing: border-box;
            }
        </style>
        <h1 class="uie-phone-clock-lg" style="font-size:3.5em; margin:0; font-weight:100; color:white; display:flex; align-items:baseline; justify-content:center; gap:10px;">
            <span class="uie-phone-clock-time-lg">12:00</span>
            <span class="uie-phone-clock-ampm-lg" style="font-size:0.28em; font-weight:800; opacity:0.9; letter-spacing:0.12em;">PM</span>
        </h1>
        <div class="uie-phone-date" style="font-size:0.95em; color:#ddd; margin-top:6px; margin-bottom:18px;">—</div>
        <div style="font-size:0.9em; color:#ccc; margin-bottom:20px;">Swipe to Unlock</div>
        <input type="password" id="uie-phone-pin" class="p-pin-input" placeholder="PIN" maxlength="4" style="display:none;">
        <button id="uie-phone-unlock-btn" style="margin-top:20px; padding:12px 30px; background:rgba(255,255,255,0.2); border:none; color:white; border-radius:25px; font-weight:bold; cursor:pointer; pointer-events:auto;">Unlock</button>
        <div id="uie-lock-msg" style="color:#e74c3c; font-size:0.8em; margin-top:10px; height:1em;"></div>
    </div>

    <div id="uie-phone-homescreen" class="phone-screen" style="display:none;">
        <i class="fa-solid fa-lock" id="uie-phone-lock-btn"></i>
        <div class="phone-grid-scroll">
            <div class="phone-grid" id="uie-phone-grid">
                <div class="phone-app-icon" id="app-msg" style="background:#2ecc71;"><i class="fa-solid fa-comment"></i></div>
                <div class="phone-app-icon" id="app-browser" style="background:#3498db;"><i class="fa-solid fa-earth-americas"></i></div>
                <div class="phone-app-icon" id="app-contacts" style="background:#8e44ad;"><i class="fa-solid fa-address-book"></i></div>
                <div class="phone-app-icon" id="app-store" style="background:#007aff;"><i class="fa-solid fa-bag-shopping"></i></div>
                <div class="phone-app-icon" id="app-settings" style="background:#95a5a6;"><i class="fa-solid fa-gear"></i></div>
                <div class="phone-app-icon" id="app-books" style="background:#c97c2b;"><i class="fa-solid fa-book"></i></div>
                <div class="phone-app-icon" id="app-calc" style="background:#1abc9c;"><i class="fa-solid fa-calculator"></i></div>
                <div class="phone-app-icon" id="app-cookies" style="background:#e67e22;"><i class="fa-solid fa-cookie-bite"></i></div>
            </div>
        </div>
        <div style="position:absolute; bottom:20px; width:100%; display:flex; justify-content:center; gap:15px; padding:15px; background:rgba(255,255,255,0.2); border-radius:20px; width:90%; left:5%;">
            <div class="phone-app-icon" id="dock-btn-phone" style="background:#2c3e50; width:40px; height:40px;"><i class="fa-solid fa-phone"></i></div>
            <div class="phone-app-icon" id="dock-btn-msg" style="background:#2c3e50; width:40px; height:40px;"><i class="fa-solid fa-comment-dots"></i></div>
            <div class="phone-app-icon" id="dock-btn-browser" style="background:#2c3e50; width:40px; height:40px;"><i class="fa-solid fa-compass"></i></div>
        </div>
    </div>

    <div id="uie-app-settings-view" class="phone-app-window">
        <div class="phone-app-header"><i class="fa-solid fa-chevron-left phone-back-btn"></i><span>Settings</span></div>
        <div class="phone-app-content">
            <div class="p-setting-row">
                <label class="p-setting-label">Wallpaper</label>
                <label class="p-file-upload">
                    <i class="fa-solid fa-image"></i>
                    <span id="p-bg-filename">Choose...</span>
                    <input type="file" id="p-set-bg-file" accept="image/*" style="display:none;">
                </label>
            </div>
            <div class="p-setting-row">
                <label class="p-setting-label">Lock Screen</label>
                <label class="p-file-upload">
                    <i class="fa-solid fa-mobile-screen"></i>
                    <span id="p-lock-filename">Choose...</span>
                    <input type="file" id="p-set-lock-file" accept="image/*" style="display:none;">
                </label>
            </div>
            <div class="p-setting-row"><label class="p-setting-label">PIN</label><input type="text" id="p-set-pin" class="p-setting-input"></div>
            <div class="p-setting-row" style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
                <label class="p-setting-label" style="margin:0;">Incoming Calls</label>
                <input type="checkbox" id="p-allow-calls">
            </div>
            <div class="p-setting-row" style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
                <label class="p-setting-label" style="margin:0;">Incoming Texts</label>
                <input type="checkbox" id="p-allow-texts">
            </div>
            <div class="p-setting-row" style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
                <label class="p-setting-label" style="margin:0;">Bubble Color (You)</label>
                <input type="color" id="p-bubble-sent" value="#f1c40f">
            </div>
            <div class="p-setting-row" style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
                <label class="p-setting-label" style="margin:0;">Bubble Color (Them)</label>
                <input type="color" id="p-bubble-recv" value="#111111">
            </div>
            <button id="p-save-btn" class="p-save-btn">Save Changes</button>
        </div>
    </div>

    <div id="uie-app-store-view" class="phone-app-window">
        <div class="phone-app-header"><i class="fa-solid fa-chevron-left phone-back-btn"></i><span>App Store</span></div>
        <div class="phone-app-content" style="padding:0;">
            <div style="padding:12px; background:linear-gradient(180deg,#0b101c,#0b101c); border-bottom:1px solid rgba(255,255,255,0.10); color:#fff;">
                <div style="display:flex; align-items:center; gap:10px;">
                    <div style="width:40px; height:40px; border-radius:14px; background:rgba(255,255,255,0.06); display:grid; place-items:center; border:1px solid rgba(255,255,255,0.10);"><i class="fa-solid fa-cube" style="color:#fff;"></i></div>
                    <div style="flex:1; min-width:0;">
                        <div style="font-weight:900; letter-spacing:0.4px;">App Builder</div>
                        <div style="opacity:0.7; font-size:12px;">Generate → Preview → Install</div>
                    </div>
                </div>
                <div style="display:flex; flex-direction:column; gap:8px; margin-top:10px;">
                    <input type="text" id="store-app-name" placeholder="Name" style="height:38px; padding:0 12px; border:1px solid rgba(255,255,255,0.12); border-radius:14px; background:rgba(0,0,0,0.25); color:#fff;">
                    <textarea id="store-app-desc" rows="2" placeholder="Description..." style="padding:10px 12px; border:1px solid rgba(255,255,255,0.12); border-radius:14px; background:rgba(0,0,0,0.25); color:#fff; resize:none;"></textarea>
                    <select id="store-app-template" style="height:38px; padding:0 12px; border:1px solid rgba(255,255,255,0.12); border-radius:14px; background:rgba(0,0,0,0.25); color:#fff;">
                        <option value="tool">Tool / Dashboard</option>
                        <option value="shop">Shop / Catalog</option>
                        <option value="notes">Notes / Journal</option>
                        <option value="quest">Quest Tracker</option>
                    </select>
                    <div style="display:flex; gap:8px;">
                        <button id="store-gen-btn" style="flex:1; height:38px; background:#fff; color:#000; border:none; border-radius:14px; font-weight:900; cursor:pointer;">Generate</button>
                        <button id="store-preview-btn" style="flex:1; height:38px; background:rgba(255,255,255,0.06); color:#fff; border:1px solid rgba(255,255,255,0.12); border-radius:14px; font-weight:900; cursor:pointer;">Preview</button>
                    </div>
                    <button id="store-create-btn" style="height:38px; background:#2ecc71; color:#000; border:none; border-radius:14px; font-weight:900; cursor:pointer;">Install Draft</button>
                </div>
                <div id="store-draft-status" style="margin-top:8px; font-size:12px; color:rgba(255,255,255,0.7);">No draft yet.</div>
            </div>
            <div style="padding:12px; background:#0b101c; color:#fff;"><div style="font-weight:900; margin-bottom:10px;">My Apps</div><div id="store-installed-list"></div></div>
        </div>
    </div>

    

    <div id="uie-app-msg-view" class="phone-app-window">
        <div class="phone-app-header">
            <i class="fa-solid fa-chevron-left phone-back-btn"></i>
            <i class="fa-solid fa-user-slash" id="msg-block" title="Block / Unblock contact" style="padding:10px; opacity:0.85; cursor:pointer;"></i>
            <i class="fa-solid fa-trash" id="msg-del-thread" title="Delete" style="padding:10px; opacity:0.85; cursor:pointer;"></i>
            <i class="fa-solid fa-plus" id="msg-new-number" title="Text a number" style="padding:10px; opacity:0.85; cursor:pointer;"></i>
            <span id="msg-contact-name">Messages</span>
        </div>
        <div class="phone-app-content p-msg-list" id="msg-container"></div>
        <div class="p-input-area">
            <button id="msg-attach-btn" title="Send image" style="width:42px; height:40px; border-radius:999px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; display:grid; place-items:center; cursor:pointer;"><i class="fa-solid fa-paperclip"></i></button>
            <button id="msg-sticker-btn" title="Stickers" style="width:42px; height:40px; border-radius:999px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; display:grid; place-items:center; cursor:pointer;"><i class="fa-regular fa-face-smile"></i></button>
            <textarea id="msg-input" rows="1" placeholder="Message..." style="flex:1; min-width:0; padding:10px 14px; border-radius:18px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; resize:none; overflow:auto; max-height:120px;"></textarea>
            <button id="msg-send-btn" style="background:#007aff; color:white; border:none; border-radius:999px; width:44px; height:40px; cursor:pointer; display:grid; place-items:center;"><i class="fa-solid fa-arrow-up"></i></button>
            <input type="file" id="msg-attach-file" accept="image/*" style="display:none;">
        </div>
    </div>

    <div id="uie-app-dial-view" class="phone-app-window">
        <div class="phone-app-header"><i class="fa-solid fa-chevron-left phone-back-btn"></i><span>Phone</span></div>
        <div class="phone-app-content" style="padding:14px; display:flex; flex-direction:column; gap:12px;">
            <div style="display:flex; align-items:center; gap:10px;">
                <div style="font-weight:900; color:#fff; opacity:0.85;">Recents</div>
                <button id="dial-recents-clear" title="Clear call log" style="margin-left:auto; height:34px; padding:0 10px; border-radius:12px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900; cursor:pointer;">Clear</button>
            </div>
            <div id="dial-recents" style="max-height:160px; overflow:auto; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); padding:10px;"></div>
            <div id="dial-display" style="height:44px; border-radius:14px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.22); color:#fff; display:flex; align-items:center; justify-content:center; font-weight:900; letter-spacing:1px; font-size:1.05em;">—</div>
            <div id="dial-pad" style="display:grid; grid-template-columns: repeat(3, 1fr); gap:10px;">
                <button class="dial-btn" data-digit="1" style="height:56px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">1</button>
                <button class="dial-btn" data-digit="2" style="height:56px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">2</button>
                <button class="dial-btn" data-digit="3" style="height:56px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">3</button>
                <button class="dial-btn" data-digit="4" style="height:56px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">4</button>
                <button class="dial-btn" data-digit="5" style="height:56px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">5</button>
                <button class="dial-btn" data-digit="6" style="height:56px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">6</button>
                <button class="dial-btn" data-digit="7" style="height:56px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">7</button>
                <button class="dial-btn" data-digit="8" style="height:56px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">8</button>
                <button class="dial-btn" data-digit="9" style="height:56px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">9</button>
                <button class="dial-btn" data-digit="*" style="height:56px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">*</button>
                <button class="dial-btn" data-digit="0" style="height:56px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">0</button>
                <button class="dial-btn" data-digit="#" style="height:56px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">#</button>
            </div>
            <div style="display:flex; gap:10px; margin-top:4px;">
                <button id="dial-backspace" style="flex:1; height:44px; border-radius:14px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900; cursor:pointer;">Del</button>
                <button id="dial-save" style="flex:1; height:44px; border-radius:14px; border:1px solid rgba(255,255,255,0.12); background:rgba(255,255,255,0.06); color:#fff; font-weight:900; cursor:pointer;">Save</button>
                <button id="dial-call" style="flex:1; height:44px; border-radius:14px; border:none; background:#2ecc71; color:#000; font-weight:900; cursor:pointer;">Call</button>
            </div>
        </div>
    </div>

    <div id="uie-app-browser-view" class="phone-app-window">
        <div class="p-browser-bar">
            <button id="p-browser-back" title="Back"><i class="fa-solid fa-chevron-left"></i></button>
            <button id="p-browser-fwd" title="Forward"><i class="fa-solid fa-chevron-right"></i></button>
            <textarea id="p-browser-url" rows="1" placeholder="Search or enter location..."></textarea>
            <button id="p-browser-go" title="Go"><i class="fa-solid fa-arrow-right"></i></button>
            <button id="p-browser-save" title="Save Page" style="color:#f1c40f;"><i class="fa-solid fa-bookmark"></i></button>
        </div>
        <div class="phone-app-header" id="p-app-header" style="display:none;">
            <i class="fa-solid fa-chevron-left phone-back-btn"></i><span id="p-app-title">App</span>
        </div>
        <div class="phone-app-content" style="padding:0; padding-bottom:50px;"><div id="p-browser-content"></div></div>
        <div class="phone-nav-bar">
            <i class="fa-solid fa-chevron-left p-nav-btn phone-back-btn"></i><i class="fa-solid fa-house p-nav-btn" id="p-browser-home"></i><i class="fa-solid fa-rotate-right p-nav-btn" id="p-browser-refresh"></i>
        </div>
    </div>

    <div id="uie-app-books-view" class="phone-app-window">
        <div class="phone-app-header"><i class="fa-solid fa-chevron-left phone-back-btn"></i><span>Books</span></div>
        <div class="phone-app-content" style="padding:0; display:flex; flex-direction:column; background:rgba(0,0,0,0.10);">
            <style>
                #uie-phone-window #uie-app-books-view .books-tabs { display:flex; gap:8px; padding:10px; border-bottom:1px solid rgba(255,255,255,0.10); background:rgba(0,0,0,0.20); }
                #uie-phone-window #uie-app-books-view .books-tab { flex:1; height:34px; border-radius:999px; border:1px solid rgba(255,255,255,0.12); background:rgba(255,255,255,0.06); color:#ddd; font-weight:900; cursor:pointer; }
                #uie-phone-window #uie-app-books-view .books-tab.active { background:#cba35c; color:#000; border:none; }
                #uie-phone-window #uie-app-books-view .books-pane { flex:1; overflow:auto; padding:12px; }
                #uie-phone-window #uie-app-books-view .books-card { border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.22); color:#fff; padding:12px; }
                #uie-phone-window #uie-app-books-view .books-input { flex:1; height:40px; border-radius:14px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.25); color:#fff; padding:0 12px; outline:none; }
                #uie-phone-window #uie-app-books-view .books-go { height:40px; padding:0 14px; border-radius:14px; border:none; background:#2ecc71; color:#000; font-weight:900; cursor:pointer; }
                #uie-phone-window #uie-app-books-view .books-wand { height:40px; width:44px; border-radius:14px; border:1px solid rgba(255,255,255,0.12); background:rgba(255,255,255,0.06); color:#fff; font-weight:900; cursor:pointer; }
                #uie-phone-window #uie-app-books-view .books-row { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
                #uie-phone-window #uie-app-books-view .books-row .books-input { min-width: 0; flex: 1 1 160px; }
                #uie-phone-window #uie-app-books-view .books-row .books-go { flex: 0 0 auto; }
                #uie-phone-window #uie-app-books-view .books-row .books-wand { flex: 0 0 auto; }
                #uie-phone-window #uie-app-books-view .book-row { border-radius:14px; border:1px solid rgba(255,255,255,0.10); background:rgba(0,0,0,0.18); cursor:pointer; padding:12px; color:#fff; }
                #uie-phone-window #uie-app-books-view .book-row:hover { background:rgba(255,255,255,0.08); }
                #uie-phone-window #uie-app-books-view #books-reader { border:1px solid rgba(255,255,255,0.12); border-radius:16px; overflow:hidden; }
                #uie-phone-window #uie-app-books-view #books-reader-head { padding:10px; background:rgba(0,0,0,0.35); border-bottom:1px solid rgba(255,255,255,0.10); display:flex; gap:10px; align-items:center; color:#fff; }
                #uie-phone-window #uie-app-books-view #books-reader-close { margin-left:auto; height:32px; padding:0 10px; border-radius:12px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.25); color:#fff; font-weight:900; cursor:pointer; }
                #uie-phone-window #uie-app-books-view #books-reader-body { padding:14px; background:#f7f2e8; color:#2c1e10; font-family: Iowan Old Style, Palatino Linotype, Book Antiqua, Palatino, Georgia, serif; line-height:1.6; }
            </style>
            <div class="books-tabs">
                <button id="books-tab-guide" class="books-tab active">Guide</button>
                <button id="books-tab-library" class="books-tab">Library</button>
            </div>

            <div id="books-view-guide" class="books-pane">
                <div class="books-card" style="background:rgba(0,0,0,0.22);">
                    <div style="font-weight:900; font-size:1.4em; margin-bottom:12px; color:#cba35c; text-align:center; border-bottom:1px solid rgba(225,193,122,0.3); padding-bottom:8px;">UIE User Manual</div>
                    
                    <div style="opacity:0.92; color:#e5e5e5; line-height:1.6; font-size:0.95em;">
                        <p>Welcome to the Universal Immersion Engine. This manual covers all core features. Click a section below or scroll to read.</p>
                        
                        <div id="guide-toc" style="display:flex; flex-wrap:wrap; gap:8px; margin-bottom:20px;">
                            <button onclick="document.getElementById('guide-inventory').scrollIntoView({behavior:'smooth'})" style="background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); color:#fff; padding:4px 8px; border-radius:6px; cursor:pointer;">Inventory</button>
                            <button onclick="document.getElementById('guide-warroom').scrollIntoView({behavior:'smooth'})" style="background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); color:#fff; padding:4px 8px; border-radius:6px; cursor:pointer;">War Room</button>
                            <button onclick="document.getElementById('guide-party').scrollIntoView({behavior:'smooth'})" style="background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); color:#fff; padding:4px 8px; border-radius:6px; cursor:pointer;">Party</button>
                            <button onclick="document.getElementById('guide-social').scrollIntoView({behavior:'smooth'})" style="background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); color:#fff; padding:4px 8px; border-radius:6px; cursor:pointer;">Social</button>
                            <button onclick="document.getElementById('guide-map').scrollIntoView({behavior:'smooth'})" style="background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); color:#fff; padding:4px 8px; border-radius:6px; cursor:pointer;">Map</button>
                            <button onclick="document.getElementById('guide-calendar').scrollIntoView({behavior:'smooth'})" style="background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); color:#fff; padding:4px 8px; border-radius:6px; cursor:pointer;">Calendar</button>
                            <button onclick="document.getElementById('guide-journal').scrollIntoView({behavior:'smooth'})" style="background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); color:#fff; padding:4px 8px; border-radius:6px; cursor:pointer;">Journal</button>
                            <button onclick="document.getElementById('guide-shop').scrollIntoView({behavior:'smooth'})" style="background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); color:#fff; padding:4px 8px; border-radius:6px; cursor:pointer;">Shop</button>
                            <button onclick="document.getElementById('guide-crafting').scrollIntoView({behavior:'smooth'})" style="background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); color:#fff; padding:4px 8px; border-radius:6px; cursor:pointer;">Crafting</button>
                            <button onclick="document.getElementById('guide-phone').scrollIntoView({behavior:'smooth'})" style="background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); color:#fff; padding:4px 8px; border-radius:6px; cursor:pointer;">Phone</button>
                            <button onclick="document.getElementById('guide-settings').scrollIntoView({behavior:'smooth'})" style="background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); color:#fff; padding:4px 8px; border-radius:6px; cursor:pointer;">Settings</button>
                        </div>

                        <div id="guide-inventory" style="padding:10px; border-radius:8px; background:rgba(0,0,0,0.2); margin-bottom:15px;">
                            <h3 style="color:#f1c40f; margin:0 0 8px 0; border-bottom:1px solid rgba(241,196,15,0.3); padding-bottom:4px;">Inventory & Equipment</h3>
                            <p><strong>Tabs:</strong> Switch between Items, Skills, Assets, Equipment, Life, and Creation Station using the bottom/top tabs.</p>
                            <p><strong>Edit Mode (Pencil):</strong> Click the pencil icon to edit your Name, Class, Level, and stats. It also allows you to delete items or change their properties.</p>
                            <p><strong>Creation Station (Sparkle):</strong> Open the "Creation Station" menu to manually add Items, Skills, Assets, or Classes. 
                               <br>• <em>Image Gen:</em> Check "Generate Image" to automatically create a thumbnail for your new item/skill using the description.
                               <br>• <em>Scan Chat:</em> Use "Scan Chat Log" (or the global Scan button) to have the AI find loot/items/skills/assets from recent messages. Scans do not post anything into the chat.</p>
                            <p><strong>Rebirth:</strong> At Level 150+, a Rebirth option appears in the gear menu. Rebirth resets progression and grants Medallions that power permanent upgrades.</p>
                            <p><strong>Mobile View:</strong> On mobile, the Equipment tab focuses purely on your grid. Portrait and stats are hidden to give you more room.</p>
                        </div>

                        <div id="guide-warroom" style="padding:10px; border-radius:8px; background:rgba(0,0,0,0.2); margin-bottom:15px;">
                            <h3 style="color:#e74c3c; margin:0 0 8px 0; border-bottom:1px solid rgba(231,76,60,0.3); padding-bottom:4px;">War Room</h3>
                            <p><strong>Scanning:</strong> Click "Scan Chat" (or the global Scan button) to analyze recent messages for combatants. The AI will populate enemies, combat state, and a short combat log.</p>
                            <p><strong>Turn Order:</strong> Drag and drop combatants to reorder them.</p>
                            <p><strong>Dice Rolling:</strong> Enable dice in settings to have rolls injected into the chat for the AI to see.</p>
                        </div>

                        <div id="guide-party" style="padding:10px; border-radius:8px; background:rgba(0,0,0,0.2); margin-bottom:15px;">
                            <h3 style="color:#3498db; margin:0 0 8px 0; border-bottom:1px solid rgba(52,152,219,0.3); padding-bottom:4px;">Party Management</h3>
                            <p><strong>Roster:</strong> View all members. Import users or scan chat for characters.</p>
                            <p><strong>Member Sheet:</strong> Edit stats, bio, and visuals for each member. Assign a portrait!</p>
                            <p><strong>Gear:</strong> Equip your party members with items from the shared party stash.</p>
                            <p><strong>Tactics:</strong> Set AI behavior (Aggressive, Healer, etc.) for auto-battles.</p>
                            <p><strong>Formation:</strong> Arrange your front, mid, and back lines to optimize defense.</p>
                        </div>

                        <div id="guide-social" style="padding:10px; border-radius:8px; background:rgba(0,0,0,0.2); margin-bottom:15px;">
                            <h3 style="color:#9b59b6; margin:0 0 8px 0; border-bottom:1px solid rgba(155,89,182,0.3); padding-bottom:4px;">Social & Contacts</h3>
                            <p><strong>Scanning:</strong> Use "Scan Chat Log" in the Social tab to find characters you've met. They will be added to your relationship list.</p>
                            <p><strong>Contacts:</strong> Phone numbers shown or saved in the story are added to Phone Contacts during a scan. Social contacts may also appear if they have known numbers.</p>
                            <p><strong>Manual Add:</strong> You can manually add friends or rivals using the + button.</p>
                        </div>

                        <div id="guide-map" style="padding:10px; border-radius:8px; background:rgba(0,0,0,0.2); margin-bottom:15px;">
                            <h3 style="color:#2ecc71; margin:0 0 8px 0; border-bottom:1px solid rgba(46,204,113,0.3); padding-bottom:4px;">Map System</h3>
                            <p><strong>Generation:</strong> Click "Generate" to create a new map based on your current location/story. The map is persistent.</p>
                            <p><strong>Markers:</strong> Drag the player marker to track your position.</p>
                        </div>

                        <div id="guide-calendar" style="padding:10px; border-radius:8px; background:rgba(0,0,0,0.2); margin-bottom:15px;">
                            <h3 style="color:#e67e22; margin:0 0 8px 0; border-bottom:1px solid rgba(230,126,34,0.3); padding-bottom:4px;">Calendar</h3>
                            <p><strong>Sync:</strong> Synchronize game time with real time or use "AI Generate" to set the date based on chat context.</p>
                            <p><strong>Events:</strong> Add reminders and quest deadlines. Events will persist in your save data.</p>
                        </div>

                        <div id="guide-journal" style="padding:10px; border-radius:8px; background:rgba(0,0,0,0.2); margin-bottom:15px;">
                            <h3 style="color:#f39c12; margin:0 0 8px 0; border-bottom:1px solid rgba(243,156,18,0.3); padding-bottom:4px;">Journal & Databank</h3>
                            <p><strong>Journal:</strong> Write daily entries or auto-generate them from chat using the "Generate Entry" button.</p>
                            <p><strong>Quests:</strong> Track active, pending, and completed missions. Use the AI helper to organize your quest log.</p>
                            <p><strong>Databank:</strong> Store lore, facts, and important memories. Useful for keeping track of complex world details.</p>
                        </div>

                        <div id="guide-shop" style="padding:10px; border-radius:8px; background:rgba(0,0,0,0.2); margin-bottom:15px;">
                            <h3 style="color:#f1c40f; margin:0 0 8px 0; border-bottom:1px solid rgba(241,196,15,0.3); padding-bottom:4px;">Shop</h3>
                            <p><strong>Stock:</strong> View available items. Use "Generate Stock" to populate the shop based on the current location/merchant.</p>
                            <p><strong>Per-Chat State:</strong> Shop inventory is stored per-chat, so different chats can have different merchants and stock.</p>
                        </div>

                        <div id="guide-crafting" style="padding:10px; border-radius:8px; background:rgba(0,0,0,0.2); margin-bottom:15px;">
                            <h3 style="color:#9b59b6; margin:0 0 8px 0; border-bottom:1px solid rgba(155,89,182,0.3); padding-bottom:4px;">Crafting</h3>
                            <p><strong>Alchemy:</strong> Mix reagents to brew potions and poisons. Discover recipes by experimenting.</p>
                            <p><strong>Forge:</strong> Smith weapons and armor from raw materials. Higher quality materials yield better stats.</p>
                            <p><strong>Enchant:</strong> Imbue items with magical properties using runes. Requires mana and specific components.</p>
                        </div>

                        <div id="guide-phone" style="padding:10px; border-radius:8px; background:rgba(0,0,0,0.2); margin-bottom:15px;">
                            <h3 style="color:#3498db; margin:0 0 8px 0; border-bottom:1px solid rgba(52,152,219,0.3); padding-bottom:4px;">Phone & Apps</h3>
                            <p><strong>Messages:</strong> Text characters in the RPG. The AI replies in-character. Use the "+" to text a new number.</p>
                            <p><strong>Browser:</strong> A simulated web browser. AI generates the webpages based on your search.</p>
                            <p><strong>App Builder:</strong> Create your own mini-apps! Describe what you want (e.g. "A stock market tracker" or "A spellbook"), preview it, and install it to your home screen.</p>
                            <p><strong>Books:</strong> You are here! Use the Library tab to generate and read books about the lore of your world.</p>
                        </div>

                        <div id="guide-settings" style="padding:10px; border-radius:8px; background:rgba(0,0,0,0.2); margin-bottom:15px;">
                            <h3 style="color:#95a5a6; margin:0 0 8px 0; border-bottom:1px solid rgba(149,165,166,0.3); padding-bottom:4px;">Settings & AI</h3>
                            <p><strong>Turbo API:</strong> For best performance, enable the Turbo API setting and point it to a fast model (like Gemini Flash or Haiku). This powers the background scans (Map, Loot, Phone replies) without slowing down your main chat.</p>
                            <p><strong>Image Generation:</strong> UIE supports Stable Diffusion (ComfyUI or A1111/SD.Next) and OpenAI-compatible image endpoints. When you enter a backend URL, UIE attempts to detect the backend and populate Checkpoint / Sampler / Scheduler dropdowns. Use the refresh button after changing URLs.</p>
                        </div>
                        
                        <div style="text-align:center; margin-top:20px; font-style:italic; opacity:0.6;">
                            Universal Immersion Engine v2.0
                        </div>
                    </div>
                </div>
            </div>

            <div id="books-view-library" class="books-pane" style="display:none;">
                <div class="books-card">
                    <div class="books-row">
                        <i class="fa-solid fa-book-open" style="opacity:0.8;"></i>
                        <input id="books-prompt" type="text" class="books-input" placeholder="Describe the book you want...">
                        <button id="books-go" class="books-go">GO</button>
                        <button id="books-generate" class="books-wand" title="Generate"><i class="fa-solid fa-wand-magic-sparkles"></i></button>
                    </div>
                    <div style="opacity:0.75; font-size:12px; margin-top:8px; font-weight:800;">Tip: Press Enter for GO.</div>
                </div>
                <div id="books-list" style="display:flex; flex-direction:column; gap:10px; margin-top:12px;"></div>
                <div id="books-reader" style="display:none; margin-top:12px;">
                    <div id="books-reader-head">
                        <button id="books-reader-close" title="Close" style="margin-left:auto; width:42px; height:32px; border-radius:12px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.25); color:#fff; font-weight:900; cursor:pointer;">×</button>
                    </div>
                    <div id="books-reader-body"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="uie-app-calc-view" class="phone-app-window">
        <div class="phone-app-header"><i class="fa-solid fa-chevron-left phone-back-btn"></i><span>Calculator</span></div>
        <div class="phone-app-content" style="padding:14px; background:#0b101c; color:#fff; display:flex; flex-direction:column; gap:12px;">
            <div id="calc-display" style="height:60px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.25); padding:12px; display:flex; align-items:flex-end; justify-content:flex-end; font-weight:900; font-size:22px; overflow:hidden; white-space:nowrap;">0</div>
            <div style="display:grid; grid-template-columns: repeat(4, 1fr); gap:10px;">
                <button class="calc-btn" data-act="clear" style="height:52px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(255,255,255,0.06); color:#fff; font-weight:900;">AC</button>
                <button class="calc-btn" data-act="back" style="height:52px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(255,255,255,0.06); color:#fff; font-weight:900;">⌫</button>
                <button class="calc-btn" data-val="%" style="height:52px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(255,255,255,0.06); color:#fff; font-weight:900;">%</button>
                <button class="calc-btn" data-val="/" style="height:52px; border-radius:16px; border:none; background:#cba35c; color:#000; font-weight:900;">÷</button>

                <button class="calc-btn" data-val="7" style="height:52px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">7</button>
                <button class="calc-btn" data-val="8" style="height:52px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">8</button>
                <button class="calc-btn" data-val="9" style="height:52px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">9</button>
                <button class="calc-btn" data-val="*" style="height:52px; border-radius:16px; border:none; background:#cba35c; color:#000; font-weight:900;">×</button>

                <button class="calc-btn" data-val="4" style="height:52px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">4</button>
                <button class="calc-btn" data-val="5" style="height:52px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">5</button>
                <button class="calc-btn" data-val="6" style="height:52px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">6</button>
                <button class="calc-btn" data-val="-" style="height:52px; border-radius:16px; border:none; background:#cba35c; color:#000; font-weight:900;">−</button>

                <button class="calc-btn" data-val="1" style="height:52px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">1</button>
                <button class="calc-btn" data-val="2" style="height:52px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">2</button>
                <button class="calc-btn" data-val="3" style="height:52px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">3</button>
                <button class="calc-btn" data-val="+" style="height:52px; border-radius:16px; border:none; background:#cba35c; color:#000; font-weight:900;">+</button>

                <button class="calc-btn" data-val="0" style="height:52px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900; grid-column: span 2;">0</button>
                <button class="calc-btn" data-val="." style="height:52px; border-radius:16px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.18); color:#fff; font-weight:900;">.</button>
                <button class="calc-btn" data-act="eq" style="height:52px; border-radius:16px; border:none; background:#2ecc71; color:#000; font-weight:900;">=</button>
            </div>
        </div>
    </div>

    
    
    <div id="uie-app-cookies-view" class="phone-app-window">
        <div class="phone-app-header"><i class="fa-solid fa-chevron-left phone-back-btn"></i><span>Data & Storage</span></div>
        <div class="phone-app-content" style="padding:0; background:#f5f5f7; color:#1d1d1f; display:flex; flex-direction:column; height:100%;">
            <div style="padding:20px 16px; background:#fff; margin-bottom:10px;">
                <div style="font-size:28px; font-weight:700; margin-bottom:4px;">Storage</div>
                <div style="font-size:14px; color:#86868b;" id="cookies-total-size">Calculating...</div>
            </div>
            
            <div style="padding:0 16px; flex:1; overflow-y:auto;">
                <div style="font-size:12px; color:#86868b; text-transform:uppercase; font-weight:600; margin-bottom:8px; margin-top:10px;">Categories</div>
                
                <div style="background:#fff; border-radius:10px; overflow:hidden; margin-bottom:20px;">
                    <div class="cookie-row" data-cat="logs" style="padding:12px 16px; display:flex; align-items:center; border-bottom:1px solid #e5e5e5; cursor:pointer;">
                        <div style="width:32px; height:32px; background:#34c759; border-radius:6px; display:grid; place-items:center; color:#fff; margin-right:12px;"><i class="fa-solid fa-scroll"></i></div>
                        <div style="flex:1; font-weight:500;">RP Logs</div>
                        <div class="cookie-size" id="size-logs" style="color:#86868b; font-size:14px;">0 KB</div>
                        <i class="fa-solid fa-chevron-right" style="color:#c7c7cc; margin-left:8px; font-size:12px;"></i>
                    </div>
                    <div class="cookie-row" data-cat="browser" style="padding:12px 16px; display:flex; align-items:center; border-bottom:1px solid #e5e5e5; cursor:pointer;">
                        <div style="width:32px; height:32px; background:#007aff; border-radius:6px; display:grid; place-items:center; color:#fff; margin-right:12px;"><i class="fa-solid fa-globe"></i></div>
                        <div style="flex:1; font-weight:500;">Web Cache</div>
                        <div class="cookie-size" id="size-browser" style="color:#86868b; font-size:14px;">0 KB</div>
                        <i class="fa-solid fa-chevron-right" style="color:#c7c7cc; margin-left:8px; font-size:12px;"></i>
                    </div>
                    <div class="cookie-row" data-cat="maps" style="padding:12px 16px; display:flex; align-items:center; border-bottom:1px solid #e5e5e5; cursor:pointer;">
                        <div style="width:32px; height:32px; background:#ff9500; border-radius:6px; display:grid; place-items:center; color:#fff; margin-right:12px;"><i class="fa-solid fa-map"></i></div>
                        <div style="flex:1; font-weight:500;">Maps</div>
                        <div class="cookie-size" id="size-maps" style="color:#86868b; font-size:14px;">0 KB</div>
                        <i class="fa-solid fa-chevron-right" style="color:#c7c7cc; margin-left:8px; font-size:12px;"></i>
                    </div>
                    <div class="cookie-row" data-cat="books" style="padding:12px 16px; display:flex; align-items:center; border-bottom:1px solid #e5e5e5; cursor:pointer;">
                        <div style="width:32px; height:32px; background:#a2845e; border-radius:6px; display:grid; place-items:center; color:#fff; margin-right:12px;"><i class="fa-solid fa-book"></i></div>
                        <div style="flex:1; font-weight:500;">Books</div>
                        <div class="cookie-size" id="size-books" style="color:#86868b; font-size:14px;">0 KB</div>
                        <i class="fa-solid fa-chevron-right" style="color:#c7c7cc; margin-left:8px; font-size:12px;"></i>
                    </div>
                    <div class="cookie-row" data-cat="numbers" style="padding:12px 16px; display:flex; align-items:center; border-bottom:1px solid #e5e5e5; cursor:pointer;">
                        <div style="width:32px; height:32px; background:#0a84ff; border-radius:6px; display:grid; place-items:center; color:#fff; margin-right:12px;"><i class="fa-solid fa-phone"></i></div>
                        <div style="flex:1; font-weight:500;">Saved Numbers</div>
                        <div class="cookie-size" id="size-numbers" style="color:#86868b; font-size:14px;">0 KB</div>
                        <i class="fa-solid fa-chevron-right" style="color:#c7c7cc; margin-left:8px; font-size:12px;"></i>
                    </div>
                    <div class="cookie-row" data-cat="state" style="padding:12px 16px; display:flex; align-items:center; cursor:pointer;">
                        <div style="width:32px; height:32px; background:#af52de; border-radius:6px; display:grid; place-items:center; color:#fff; margin-right:12px;"><i class="fa-solid fa-database"></i></div>
                        <div style="flex:1; font-weight:500;">World State</div>
                        <div class="cookie-size" id="size-state" style="color:#86868b; font-size:14px;">0 KB</div>
                        <i class="fa-solid fa-chevron-right" style="color:#c7c7cc; margin-left:8px; font-size:12px;"></i>
                    </div>
                </div>

                <div style="text-align:center; margin-bottom:20px;">
                    <button id="cookies-clear-all" style="background:#fff; color:#ff3b30; border:1px solid #e5e5e5; padding:12px 24px; border-radius:12px; font-size:16px; font-weight:600; cursor:pointer; width:100%;">Clear All Data</button>
                    <div style="margin-top:8px; font-size:12px; color:#86868b;">This will remove all generated content and logs.</div>
                </div>
            </div>
            
            <!-- Detail View Overlay -->
            <div id="cookies-detail-view" style="position:absolute; top:0; left:0; width:100%; height:100%; background:#f5f5f7; display:none; flex-direction:column; z-index:10;">
                <div class="phone-app-header" style="background:#fff; border-bottom:1px solid #e5e5e5;">
                    <i class="fa-solid fa-chevron-left" id="cookies-detail-back" style="padding:10px; cursor:pointer; color:#007aff;"></i>
                    <span id="cookies-detail-title" style="color:#1d1d1f;">Category</span>
                </div>
                <div style="padding:16px; flex:1; overflow-y:auto;">
                    <div style="margin-bottom:12px; position:relative;">
                        <i class="fa-solid fa-magnifying-glass" style="position:absolute; left:12px; top:10px; color:#86868b;"></i>
                        <input type="text" id="cookies-search" placeholder="Search items..." style="width:100%; padding:8px 12px 8px 36px; border-radius:10px; border:none; background:#e3e3e8; font-size:15px; color:#1d1d1f; outline:none;">
                    </div>
                    <div id="cookies-detail-list" style="background:#fff; border-radius:10px; overflow:hidden;"></div>
                    <div style="margin-top:20px;">
                        <button id="cookies-delete-cat" style="background:#fff; color:#ff3b30; border:1px solid #e5e5e5; padding:12px 24px; border-radius:12px; font-size:16px; font-weight:600; cursor:pointer; width:100%;">Delete All in Category</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="uie-app-contacts-view" class="phone-app-window">
        <div class="phone-app-header">
            <i class="fa-solid fa-chevron-left phone-back-btn"></i>
            <span>Contacts</span>
            <i class="fa-solid fa-plus" id="contact-add-manual" style="margin-left:auto; cursor:pointer; padding:5px; font-size:1.2em;" title="Add Contact"></i>
        </div>
        <div class="phone-app-content" style="position:relative;">
            <div id="contact-list"></div>
            <button id="contact-add-fab" title="Add Contact" style="position:absolute; right:14px; bottom:14px; width:46px; height:46px; border-radius:14px; border:1px solid rgba(255,255,255,0.12); background:rgba(0,0,0,0.35); color:#f1c40f; font-weight:900; display:grid; place-items:center; cursor:pointer; z-index:6;">
                <i class="fa-solid fa-plus"></i>
            </button>
        </div>
    </div>

    <div id="uie-call-screen" class="phone-app-window" style="display:none; z-index:150;">
        <div class="call-avatar" id="call-avatar-img"></div><h2 id="call-name-disp">Unknown</h2><div class="call-status">Connected</div><div class="call-timer" id="call-timer-disp">00:00</div>
        <div id="call-transcript" style="flex:1; width:90%; overflow-y:auto; margin:20px 0; font-size:0.9em; text-align:center; color:#ddd; padding:10px; border-top:1px solid rgba(255,255,255,0.1);"></div>
        <div class="call-input-row" style="width:100%; display:flex; gap:8px; margin:0 0 20px 0; padding:0 16px; box-sizing:border-box; align-items:center;">
            <input type="text" id="call-input" placeholder="Speak..." style="flex:1; min-width:0; background:rgba(255,255,255,0.1); border:none; color:white; padding:10px 12px; border-radius:18px;">
            <button id="call-speak-btn" style="background:white; color:black; border:none; border-radius:14px; width:34px; height:34px; cursor:pointer; display:grid; place-items:center;"><i class="fa-solid fa-comment"></i></button>
        </div>
        <div class="call-actions"><div class="call-btn-round btn-end" id="call-end-btn"><i class="fa-solid fa-phone-slash"></i></div></div>
    </div>

    <i class="fa-solid fa-xmark uie-close-btn" id="uie-phone-close" style="position:absolute; top:9px; right:5px; z-index:300; color:white; padding:5px; text-shadow:0 0 3px #000; cursor: pointer;"></i>
</div>
